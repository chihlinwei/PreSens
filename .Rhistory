colour="Region")+
theme_bw()%+replace% large #%+replace% no_strip
CD <- lapply(dh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
CND <- lapply(ndh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
sc <- rbind(cbind(Sample="Dyed", CD), cbind(Sample="Non-dyed", CND))
fr <- strsplit(sc$.id, split="_")%>%ldply
fr <- cbind(Cruise=with(fr, paste(V1, V2, sep="_")), Station=fr$V3) %>% as.data.frame
fr <- cbind(fr, en[match(with(fr, paste(Cruise, Station)), with(en, paste(Cruise, Station))), c("Region", "Longitude", "Latitude")])
sc <- cbind(fr, sc[, -2])
sc$Complete <- sc$Observed/sc$Estimator
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==0), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
#xlim(113.85, 114.45)+
#ylim(22.15, 22.6)+
labs(fill=expression(""^0*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==1), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^1*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==2), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^2*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
h$order
levels(h$order)
load("../Rdata/dh1.rda")
load("../Rdata/ndh1.rda")
h <- rbind(cbind(Sample="Dyed", ldply(lapply(dh, FUN=function(x)x$iNextEst), .id="Station")),
cbind(Sample="Non-dyed", ldply(lapply(ndh, FUN=function(x)x$iNextEst), .id="Station"))
)
h$orderL <- factor(h$order, labels= c(expression(""^0*D), expression(""^1*D), expression(""^2*D)))
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=m, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=m, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(500, 1000), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Numbers of Individuals", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=m, y=SC, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=m, y=SC, group=paste(Sample, Station)))+
geom_vline(xintercept = c(500, 1000), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Numbers of Individuals", y = "Sample Coverage",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
a <- rbind(cbind(Sample="Dyed", lapply(dh, FUN=function(x)x$iNextEst[seq(100, 300, by=100),])%>%ldply(.id="Cruise_Station")), cbind(Sample="Non-dyed", lapply(ndh, FUN=function(x)x$iNextEst[seq(100, 300, by=100),])%>%ldply(.id="Cruise_Station")))
a <- cbind(en[match(a$Cruise_Station, with(en, paste(Cruise, Station, sep="_"))),], a)
a$Region <- factor(a$Region, levels=c("Gaoping", "Fangliao", "Hongtsai", "South Bay"))
ggplot(data= a, aes(x=order, y=qD, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Order", y = "Effective Number of Species",
colour="Region")+
theme_bw()%+replace% large #%+replace% no_strip
CD <- lapply(dh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
CND <- lapply(ndh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
sc <- rbind(cbind(Sample="Dyed", CD), cbind(Sample="Non-dyed", CND))
fr <- strsplit(sc$.id, split="_")%>%ldply
fr <- cbind(Cruise=with(fr, paste(V1, V2, sep="_")), Station=fr$V3) %>% as.data.frame
fr <- cbind(fr, en[match(with(fr, paste(Cruise, Station)), with(en, paste(Cruise, Station))), c("Region", "Longitude", "Latitude")])
sc <- cbind(fr, sc[, -2])
sc$Complete <- sc$Observed/sc$Estimator
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==0), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
#xlim(113.85, 114.45)+
#ylim(22.15, 22.6)+
labs(fill=expression(""^0*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==1), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^1*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==2), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^2*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
# Minimum Sample Coverage for each order q
min(ldply(lapply(splitBy(~order+Station, subset(h, order==0)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==1)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==2)), FUN=function(x)x[dim(x)[1],]))$SC)
# Minimum Sample Coverage for each order q
min(ldply(lapply(splitBy(~order+Station, subset(h, order==0)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==1)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==2)), FUN=function(x)x[dim(x)[1],]))$SC)
# Minimum SC = 0.507
# Set SC to 0.8 (sacrifice 2 samples with low sample coverage)
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=SC, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=SC, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(0.8), linetype=3)+
facet_grid(order~Sample, scale="free", labeller = label_parsed)+
labs(x = "Sample Coverage", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
load("../Rdata/h.rda")
d0 <- lapply(splitBy(~Sample+order+Station, subset(h, order==0)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d1 <- lapply(splitBy(~Sample+order+Station, subset(h, order==1)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d2 <- lapply(splitBy(~Sample+order+Station, subset(h, order==2)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
h2 <- rbind(d0, d1, d2)
h2 <- cbind(en[match(h2$Station, with(en, paste(Cruise, Station, sep="_"))), c("Cruise", "Station", "Habitat",  "Region", "Latitude", "Longitude", "Depth")], h2[, c(-1, -3)])
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, group=Station))+
geom_line(aes(colour=Region), size=1)+
geom_point(aes(colour=Region))+
#geom_ribbon(aes(fill=Region), alpha=0.3)+
scale_colour_manual(values = as.character(kelly.colors(12)[-1:-2]))+
scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large %+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=Station))+
geom_line(aes(colour=Region), size=1)+
geom_point(aes(colour=Region))+
#geom_ribbon(aes(fill=Region, group=Station), alpha=0.3)+
scale_colour_manual(values = as.character(kelly.colors(12)[-1:-2]))+
scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Region, ncol=5, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
# Minimum Sample Coverage for each order q
min(ldply(lapply(splitBy(~order+Station, subset(h, order==0)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==1)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==2)), FUN=function(x)x[dim(x)[1],]))$SC)
# Minimum SC = 0.507
# Set SC to 0.8 (sacrifice 2 samples with low sample coverage)
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=SC, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=SC, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(0.8), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Sample Coverage", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
load("../Rdata/dh1.rda")
load("../Rdata/ndh1.rda")
h <- rbind(cbind(Sample="Dyed", ldply(lapply(dh, FUN=function(x)x$iNextEst), .id="Station")),
cbind(Sample="Non-dyed", ldply(lapply(ndh, FUN=function(x)x$iNextEst), .id="Station"))
)
h$orderL <- factor(h$order, labels= c(expression(""^0*D), expression(""^1*D), expression(""^2*D)))
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=m, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=m, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(500, 1000), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Numbers of Individuals", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=m, y=SC, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=m, y=SC, group=paste(Sample, Station)))+
geom_vline(xintercept = c(500, 1000), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Numbers of Individuals", y = "Sample Coverage",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
a <- rbind(cbind(Sample="Dyed", lapply(dh, FUN=function(x)x$iNextEst[seq(100, 300, by=100),])%>%ldply(.id="Cruise_Station")), cbind(Sample="Non-dyed", lapply(ndh, FUN=function(x)x$iNextEst[seq(100, 300, by=100),])%>%ldply(.id="Cruise_Station")))
a <- cbind(en[match(a$Cruise_Station, with(en, paste(Cruise, Station, sep="_"))),], a)
a$Region <- factor(a$Region, levels=c("Gaoping", "Fangliao", "Hongtsai", "South Bay"))
ggplot(data= a, aes(x=order, y=qD, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Order", y = "Effective Number of Species",
colour="Region")+
theme_bw()%+replace% large #%+replace% no_strip
CD <- lapply(dh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
CND <- lapply(ndh, FUN=function(x)cbind(order=0:2, as.data.frame(x$AsyEst)))%>%ldply
sc <- rbind(cbind(Sample="Dyed", CD), cbind(Sample="Non-dyed", CND))
fr <- strsplit(sc$.id, split="_")%>%ldply
fr <- cbind(Cruise=with(fr, paste(V1, V2, sep="_")), Station=fr$V3) %>% as.data.frame
fr <- cbind(fr, en[match(with(fr, paste(Cruise, Station)), with(en, paste(Cruise, Station))), c("Region", "Longitude", "Latitude")])
sc <- cbind(fr, sc[, -2])
sc$Complete <- sc$Observed/sc$Estimator
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==0), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
#xlim(113.85, 114.45)+
#ylim(22.15, 22.6)+
labs(fill=expression(""^0*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==1), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^1*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
ggplot(tw_df, aes(long,lat, group=group)) +
geom_polygon() +
geom_path(data=iso200_df, linetype=2)+
geom_path(data=iso500_df, linetype=1)+
geom_point(data=subset(sc, order==2), aes(x=Longitude, y=Latitude, group=NULL, fill=Complete), pch=21, colour="black", size=4)+
scale_fill_gradientn(colours = rev(brewer.pal(11, "Spectral")), breaks=pretty(subset(sc, order==0)$Complete))+
coord_equal()+
labs(fill=expression(""^2*C), x="Longitude", y="Latitude")+
facet_wrap(~Sample)+
theme_bw() %+replace% large %+replace% theme(legend.key.height = unit(1.5, "cm")) #%+replace% no_strip
# Minimum Sample Coverage for each order q
min(ldply(lapply(splitBy(~order+Station, subset(h, order==0)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==1)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==2)), FUN=function(x)x[dim(x)[1],]))$SC)
# Minimum SC = 0.507
# Set SC to 0.8 (sacrifice 2 samples with low sample coverage)
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=SC, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=SC, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(0.8), linetype=3)+
facet_grid(order~Sample, scale="free", labeller = label_parsed)+
labs(x = "Sample Coverage", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
# Minimum Sample Coverage for each order q
min(ldply(lapply(splitBy(~order+Station, subset(h, order==0)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==1)), FUN=function(x)x[dim(x)[1],]))$SC)
min(ldply(lapply(splitBy(~order+Station, subset(h, order==2)), FUN=function(x)x[dim(x)[1],]))$SC)
# Minimum SC = 0.507
# Set SC to 0.8 (sacrifice 2 samples with low sample coverage)
ggplot()+
geom_line(data= subset(h, method!="observed"),
aes(x=SC, y=qD, colour=method, group=paste(Sample, Station)))+
geom_point(data= subset(h, method=="observed"),
aes(x=SC, y=qD, group=paste(Sample, Station)))+
geom_vline(xintercept = c(0.8), linetype=3)+
facet_grid(orderL~Sample, scale="free", labeller = label_parsed)+
labs(x = "Sample Coverage", y = "Effective Number of Species",
colour="Method")+
theme_bw()%+replace% large #%+replace% no_strip
load("../Rdata/h.rda")
d0 <- lapply(splitBy(~Sample+order+Station, subset(h, order==0)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d1 <- lapply(splitBy(~Sample+order+Station, subset(h, order==1)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d2 <- lapply(splitBy(~Sample+order+Station, subset(h, order==2)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
h2 <- rbind(d0, d1, d2)
h2 <- cbind(en[match(h2$Station, with(en, paste(Cruise, Station, sep="_"))), c("Cruise", "Station", "Habitat",  "Region", "Latitude", "Longitude", "Depth")], h2[, c(-1, -3)])
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, group=Station))+
geom_line(aes(colour=Region), size=1)+
geom_point(aes(colour=Region))+
#geom_ribbon(aes(fill=Region), alpha=0.3)+
scale_colour_manual(values = as.character(kelly.colors(12)[-1:-2]))+
scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large %+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, group=Station))+
geom_line(aes(colour=Region), size=1)+
geom_point(aes(colour=Region))+
#geom_ribbon(aes(fill=Region), alpha=0.3)+
scale_colour_manual(values = as.character(kelly.colors(12)[-1:-2]))+
scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
#scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=Station))+
geom_line(aes(colour=Region), size=1)+
geom_point(aes(colour=Region))+
#geom_ribbon(aes(fill=Region, group=Station), alpha=0.3)+
scale_colour_manual(values = as.character(kelly.colors(12)[-1:-2]))+
scale_fill_manual(values = as.character(kelly.colors(12)[-1:-2]))+
facet_wrap(~Region, ncol=5, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=Station))+
geom_line(aes(colour=Region), size=1)
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), ncol=5, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=Station))+
geom_line(size=1)+
geom_point()
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=Station))+
geom_line()+
geom_point()
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=Station))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
head(h2)
h2
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=Station))+
geom_line(size=1)
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, group=paste(Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Region, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
load("../Rdata/h.rda")
d0 <- lapply(splitBy(~Sample+order+Station, subset(h, order==0)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d1 <- lapply(splitBy(~Sample+order+Station, subset(h, order==1)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d2 <- lapply(splitBy(~Sample+order+Station, subset(h, order==2)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
h2 <- rbind(d0, d1, d2)
h2 <- cbind(en[match(h2$Station, with(en, paste(Cruise, Station, sep="_"))), c("Cruise", "Station", "Habitat",  "Region", "Latitude", "Longitude", "Depth")], h2[, c(-1, -3)])
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=paste(Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
head(h2)
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Cruise, Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
load("../Rdata/h.rda")
d0 <- lapply(splitBy(~Sample+order+Station, subset(h, order==0)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d1 <- lapply(splitBy(~Sample+order+Station, subset(h, order==1)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
d2 <- lapply(splitBy(~Sample+order+Station, subset(h, order==2)), FUN=function(x)x[which.min(abs(x$SC-0.8)),])%>% ldply
h2 <- rbind(d0, d1, d2)
h2 <- cbind(en[match(h2$Station, with(en, paste(Cruise, Station, sep="_"))), c("Cruise", "Station", "Habitat",  "Region", "Latitude", "Longitude", "Depth")], h2[, c(-1, -3)])
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, colour=paste(Region, Habitat), group=paste(Cruise, Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~Sample)+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large #%+replace% no_strip
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Cruise, Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Cruise, Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), nrow=4, scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
ggplot(data=h2, aes(x=order, y=qD, ymin=qD.LCL, ymax=qD.UCL, linetype=Sample, colour=paste(Region, Habitat), group=paste(Cruise, Station, Sample)))+
geom_line(size=1)+
geom_point()+
scale_colour_manual(values = as.character(kelly.colors(8)[-1]))+
facet_wrap(~paste(Region, Habitat), scale="free_y")+
labs(x = "Hill Number Order q", y = "Effective Number of Species",
colour="Region", fill="Region")+
theme_bw()%+replace% large
subset(h2, Habitat=="Canyon" & Region == "Gaoping")
